<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Wall</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1 class="title">The Wall</h1>
        <p class="subtitle">leave your mark</p>
        <div class="hero-tile" id="heroTile" style="{{if .TileColors}}background: conic-gradient(from 45deg, {{range $i, $c := .TileColors}}{{if $i}}, {{end}}{{$c}}{{end}});{{else}}background: {{.VisitorColor}};{{end}}">
          <span class="hero-number">{{.TotalVisitors}}</span>
          <span class="hero-label">total visitors</span>
        </div>
        {{if .TileColors}}<p class="mosaic-hint">visitor colors</p>{{end}}
      </header>

      <section class="welcome">
        <p class="welcome-text">
          You're visitor <span class="visitor-num">#{{.VisitorNumber}}</span>. 
          Pick a color and leave your mark.
        </p>
      </section>

      <form id="entryForm" class="entry-form">
        <div class="color-picker-wrap">
          <div id="heatmapPicker" class="heatmap-picker">
            <div class="heatmap-gradient"></div>
            <div id="pickerCursor" class="picker-cursor"></div>
          </div>
          <div id="colorPreview" class="color-preview" style="background: {{.VisitorColor}}"></div>
          <input type="hidden" id="colorValue" value="{{.VisitorColor}}" />
        </div>
        <div class="input-row name-row">
          <input type="text" id="nameInput" placeholder="Visitor #{{.VisitorNumber}}" maxlength="15" autocomplete="off" />
          <span class="char-count"><span id="nameCharCount">0</span>/15</span>
        </div>
        <div class="input-row">
          <input type="text" id="messageInput" placeholder="Your message..." maxlength="40" autocomplete="off" />
          <span class="char-count"><span id="charCount">0</span>/40</span>
        </div>
        <button type="submit" id="submitBtn">Post</button>
      </form>

      <div id="guestbook" class="guestbook">
        {{range .Entries}}
        <div class="entry" style="background: {{.Color}}">
          <span class="entry-name">{{.Name}}</span>
          <p class="entry-message">{{.Message}}</p>
        </div>
        {{end}}
      </div>

      <div id="emptyState" class="empty-state" {{if .Entries}}style="display: none"{{end}}>
        <p>No entries yet. Be the first.</p>
      </div>
    </div>

    <footer class="footer">
      <p><a href="https://github.com/kamalmemon/the-wall" target="_blank">Source on GitHub</a></p>
    </footer>

    <script>
      window.VISITOR_COLOR = "{{.VisitorColor}}";
      window.VISITOR_NUMBER = {{.VisitorNumber}};
    </script>
    <script src="/static/script.js"></script>
  </body>
</html>
